<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Level 7: Salt Flats - Sodium and Chlorine</title>
    <style>
        @font-face {
            font-family: 'PixelFont';
            src: url('https://cdnjs.cloudflare.com/ajax/libs/VT323/1.3.1/VT323-Regular.ttf') format('truetype');
        }
        
        body {
            margin: 0;
            padding: 0;
            font-family: 'PixelFont', monospace;
            background-color: #fffefe;
            color: #945e7b;
            height: 100vh;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            image-rendering: pixelated;
        }
         #back-home-button {
    position: absolute;
    bottom: 20px;
    left: 20px;
    z-index: 50;
}

#return-to-menu {
    padding: 8px 15px;
    font-size: 1rem;
    background-color: #795548;
    color: white;
    border: none;
    border-radius: 5px;
    cursor: pointer;
    font-family: 'Courier New', monospace;
    transition: background-color 0.3s;
}

#return-to-menu:hover {
    background-color: #5d4037;
}

        .header {
            background-color: #f0e8e8;
            color: #945e7b;
            padding: 10px 20px;
            text-align: center;
            box-shadow: 0 2px 5px rgba(0, 255, 0, 0.2);
            border-bottom: 2px solid #945e7b;
            text-transform: uppercase;
            letter-spacing: 2px;
        }
        
        .container {
            display: flex;
            flex: 1;
            overflow: hidden;
        }
        
        .left-panel, .right-panel {
            flex: 1;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            overflow-y: auto;
            border: 2px solid #222;
            background-color: #f0e8e8;;
        }
        
        .crystal-container {
            position: relative;
            width: 300px;
            height: 300px;
            background-color: rgba(0, 0, 0, 0.7);
            border: 4px solid #333;
            outline: 2px solid #444;
            display: flex;
            justify-content: center;
            align-items: center;
            margin-bottom: 20px;
        }
        
        .salt-crystal {
            width: 200px;
            height: 200px;
            background-color: #333;
            position: relative;
            cursor: pointer;
            box-shadow: 0 0 20px rgba(255, 255, 255, 0.1);
            display: flex;
            justify-content: center;
            align-items: center;
            transition: all 0.3s ease;
            transform: scale(1);
            clip-path: polygon(
                50% 0%, 
                100% 25%, 
                100% 75%, 
                50% 100%, 
                0% 75%, 
                0% 25%
            );
        }
        
        .salt-crystal:before {
            content: '';
            position: absolute;
            width: 80%;
            height: 80%;
            background: linear-gradient(45deg, #444, #222);
            clip-path: polygon(
                50% 0%, 
                100% 25%, 
                100% 75%, 
                50% 100%, 
                0% 75%, 
                0% 25%
            );
            z-index: -1;
        }
        
        .salt-crystal:hover {
            transform: scale(1.05);
            box-shadow: 0 0 30px rgba(255, 255, 255, 0.2);
            background-color: #444;
        }
        
        .crystal-text {
            font-size: 48px;
            font-weight: bold;
            color: #000101;
            text-shadow: 2px 2px 0 #000, -2px -2px 0 #000, 2px -2px 0 #000, -2px 2px 0 #000;
        }
        
        .elements {
            display: flex;
            justify-content: space-around;
            width: 100%;
            margin-top: 40px;
        }
        
        .element {
            width: 80px;
            height: 80px;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 24px;
            font-weight: bold;
            opacity: 0.5;
            transition: all 0.3s ease;
            cursor: pointer;
            border: 3px solid;
            border-image-slice: 1;
            transform: scale(1);
            image-rendering: pixelated;
        }
        
        .sodium {
            background-color: #000;
            border-color: #0d5f5d;
            color: #092244;
            box-shadow: 0 0 10px rgba(255, 170, 0, 0.5);
        }
        
        .chlorine {
            background-color: #f0e8e8;
            border-color:#945e7b;
            color: #945e7b;
            box-shadow: 0 0 10px rgba(0, 255, 102, 0.5);
        }
        
        .element.active {
            opacity: 1;
            transform: scale(1.1);
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0% { transform: scale(1.1); }
            50% { transform: scale(1.2); }
            100% { transform: scale(1.1); }
        }
        
        .puzzle-container {
            width: 100%;
            padding: 20px;
            background-color: #f0e8e8;;
            border: 3px solid #333;
            outline: 1px solid #444;
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        
        .puzzle-title {
            font-size: 20px;
            font-weight: bold;
            margin-bottom: 15px;
            color: #945e7b;
            text-transform: uppercase;
            letter-spacing: 2px;
        }
        
        .formula-display {
            font-size: 24px;
            margin: 15px 0;
            padding: 10px 20px;
            background-color: #f0e8e8;
            border: 2px solid #945e7b;
            color: #945e7b;
            font-family: 'PixelFont', monospace;
            text-shadow: 0 0 5px #945e7b;
        }
        
        .element-dropzone {
            width: 80%;
            height: 100px;
            border: 3px dashed #444;
            display: flex;
            justify-content: center;
            align-items: center;
            margin: 20px 0;
            font-size: 16px;
            color: #888;
            background-color: #0a0a0a;
        }
        
        .element-dropzone.active {
            border-color: #945e7b;
            background-color: rgba(51, 255, 51, 0.1);
        }
        
        .journal {
            margin-top: 20px;
            padding: 15px;
            background-color: #f0e8e8;;
            border: 2px solid #555;
            border-left: 4px solid #945e7b;
            font-style: italic;
            width: 80%;
            color: #aaa;
        }
        
        .level-complete {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: #f0e8e8;;
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 100;
        }
        
        .complete-message {
            background-color: #f0e8e8;;
            padding: 30px 50px;
            border: 4px solid #945e7b;
            text-align: center;
            box-shadow: 0 0 20px rgba(51, 255, 51, 0.5);
            max-width: 80%;
            color: #945e7b;
        }
        
        .complete-message h2 {
            color: #945e7b;
            margin-bottom: 20px;
            text-transform: uppercase;
            letter-spacing: 2px;
        }
        
        .complete-message p {
            margin-bottom: 30px;
            font-size: 18px;
        }
        
        .btn {
            padding: 10px 25px;
            background-color: #f0e8e8;;
            color: #945e7b;
            border: 2px solid #945e7b;
            cursor: pointer;
            font-size: 16px;
            transition: all 0.3s;
            font-family: 'PixelFont', monospace;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        .btn:hover {
            background-color: #945e7b;
            color: #000;
            transform: translateY(-2px);
        }

        .salt-fragments {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
        }

        .fragment {
            position: absolute;
            width: 16px;
            height: 16px;
            background-color: #444;
            border: 1px solid #666;
            transition: transform 0.5s ease, opacity 0.5s ease;
        }

        .instructions {
            background-color: rgba(51, 255, 51, 0.1);
            padding: 15px;
            border: 2px solid #222;
            margin: 20px 0;
            width: 80%;
            text-align: center;
            color: #aaa;
        }
        
        /* Pixelated border effect */
        .pixel-border {
            position: relative;
        }
        
        .pixel-border:after {
            content: "";
            position: absolute;
            top: -4px;
            left: -4px;
            right: -4px;
            bottom: -4px;
            background: transparent;
            border: 4px solid #945e7b;
            clip-path: polygon(
                0% 0%, 12.5% 0%, 12.5% 12.5%, 
                25% 12.5%, 25% 0%, 37.5% 0%, 
                37.5% 12.5%, 50% 12.5%, 50% 0%, 
                62.5% 0%, 62.5% 12.5%, 75% 12.5%, 
                75% 0%, 87.5% 0%, 87.5% 12.5%, 
                100% 12.5%, 100% 25%, 87.5% 25%, 
                87.5% 37.5%, 100% 37.5%, 100% 50%, 
                87.5% 50%, 87.5% 62.5%, 100% 62.5%, 
                100% 75%, 87.5% 75%, 87.5% 87.5%, 
                100% 87.5%, 100% 100%, 87.5% 100%, 
                87.5% 87.5%, 75% 87.5%, 75% 100%, 
                62.5% 100%, 62.5% 87.5%, 50% 87.5%, 
                50% 100%, 37.5% 100%, 37.5% 87.5%, 
                25% 87.5%, 25% 100%, 12.5% 100%, 
                12.5% 87.5%, 0% 87.5%, 0% 75%, 
                12.5% 75%, 12.5% 62.5%, 0% 62.5%, 
                0% 50%, 12.5% 50%, 12.5% 37.5%, 
                0% 37.5%, 0% 25%, 12.5% 25%, 
                12.5% 12.5%, 0% 12.5%
            );
            pointer-events: none;
        }
        
        /* Scanlines effect */
        body:after {
            content: "";
            display: block;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: repeating-linear-gradient(
                0deg,
                rgba(0, 0, 0, 0.1),
                rgba(0, 0, 0, 0.1) 1px,
                transparent 1px,
                transparent 2px
            );
            pointer-events: none;
            z-index: 999;
        }
        
        /* CRT effect */
        body:before {
            content: "";
            display: block;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: radial-gradient(
                circle at center,
                transparent 0%,
                rgba(0, 0, 0, 0.2) 90%,
                rgba(0, 0, 0, 0.8) 100%
            );
            pointer-events: none;
            z-index: 998;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>Level 7: Salt Flats</h1>
        <h3>Discover Sodium and Chlorine</h3>
    </div>
    
    <div class="container">
        <div class="left-panel">
            <div class="journal">
                <p>"Two elements in the salt you eat. Break apart the crystal structure to reveal what lies within."</p>
            </div>
            
            <div class="instructions">
                <p>Click on the salt crystal to break it apart. Then drag the elements to the formula area to solve the puzzle.</p>
            </div>
            
            <div class="crystal-container pixel-border">
                <div class="salt-crystal" id="saltCrystal">
                    <span class="crystal-text">NaCl</span>
                </div>
                <div class="salt-fragments" id="saltFragments"></div>
            </div>
            
            <div class="elements">
                <div class="element sodium" id="sodium" draggable="true">Na</div>
                <div class="element chlorine" id="chlorine" draggable="true">Cl</div>
            </div>
        </div>
        
        <div class="right-panel">
            <div class="puzzle-container pixel-border">
                <div class="puzzle-title">Chemical Formula Puzzle</div>
                <div class="formula-display" id="formulaDisplay">
                    ? + ? → NaCl
                </div>
                
                <p>Drag and drop the elements in the correct order:</p>
                
                <div class="element-dropzone" id="dropZone">
                    Drop elements here
                </div>
                
                <button class="btn" id="checkBtn">Check Solution</button>
                
                <div id="hintArea" style="margin-top: 20px; font-style: italic; color: #945e7b;"></div>
            </div>
        </div>
    </div>
    
    <div class="level-complete" id="levelComplete">
        <div class="complete-message pixel-border">
            <h2>Level Complete!</h2>
            <p>You've successfully unlocked sodium and chlorine by breaking apart the salt crystal structure!</p>
            <p>These two reactive elements combine to form the salt we use every day.</p>
            <button class="btn" id="nextLevelBtn">Go to Next Level</button>
        </div>
    </div>
<div id="back-home-button">
        <button id="return-to-menu">Back to Journal</button>
    </div>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const saltCrystal = document.getElementById('saltCrystal');
            const saltFragments = document.getElementById('saltFragments');
            const sodiumElement = document.getElementById('sodium');
            const chlorineElement = document.getElementById('chlorine');
            const dropZone = document.getElementById('dropZone');
            const checkBtn = document.getElementById('checkBtn');
            const formulaDisplay = document.getElementById('formulaDisplay');
            const levelComplete = document.getElementById('levelComplete');
            const nextLevelBtn = document.getElementById('nextLevelBtn');
            const hintArea = document.getElementById('hintArea');
            
            let isCrystalBroken = false;
            let droppedElements = [];
            
            // Make elements initially inactive
            sodiumElement.style.pointerEvents = 'none';
            chlorineElement.style.pointerEvents = 'none';
            
            // Add pixelated crystal break effect
            function createPixelatedFragments() {
                saltFragments.innerHTML = '';
                // Create 6x6 grid of pixels
                for (let y = 0; y < 6; y++) {
                    for (let x = 0; x < 6; x++) {
                        const fragment = document.createElement('div');
                        fragment.className = 'fragment';
                        // Position in grid
                        const baseX = 50 + (x - 3) * 20;
                        const baseY = 50 + (y - 3) * 20;
                        fragment.style.left = `${baseX + 25}px`;
                        fragment.style.top = `${baseY + 25}px`;
                        
                        // Different colors for fragments
                        if ((x + y) % 3 === 0) {
                            fragment.style.backgroundColor = '#77ffff';
                            fragment.style.border = '1px solid #aaffff';
                        } else if ((x + y) % 3 === 1) {
                            fragment.style.backgroundColor = '#ffaa00';
                            fragment.style.border = '1px solid #ffcc00';
                        } else {
                            fragment.style.backgroundColor = '#00ff66';
                            fragment.style.border = '1px solid #00ffaa';
                        }
                        
                        saltFragments.appendChild(fragment);
                    }
                }
            }
            
            // Crystal breaking animation
            saltCrystal.addEventListener('click', function() {
                if (!isCrystalBroken) {
                    breakCrystal();
                    
                    // Make elements active after crystal breaks
                    setTimeout(() => {
                        sodiumElement.classList.add('active');
                        chlorineElement.classList.add('active');
                        sodiumElement.style.pointerEvents = 'auto';
                        chlorineElement.style.pointerEvents = 'auto';
                        
                        hintArea.textContent = 'The crystal has broken! Now you can use the elements.';
                    }, 1500);
                    
                    isCrystalBroken = true;
                }
            });
            
            function breakCrystal() {
                // Create pixelated fragments
                createPixelatedFragments();
                
                // Animate crystal breaking
                saltCrystal.style.opacity = '0';
                saltCrystal.style.transform = 'scale(0.8)';
                
                // Animate fragments flying away
                setTimeout(() => {
                    const fragments = document.querySelectorAll('.fragment');
                    fragments.forEach((fragment, index) => {
                        const angle = (index / fragments.length) * Math.PI * 2;
                        const distance = 50 + Math.random() * 150;
                        const xPos = Math.cos(angle) * distance;
                        const yPos = Math.sin(angle) * distance;
                        fragment.style.transform = `translate(${xPos}px, ${yPos}px) rotate(${Math.random() * 360}deg)`;
                        fragment.style.opacity = '0';
                    });
                }, 100);
                
                // Audio effect for crystal breaking
                try {
                    const breakSound = new Audio('data:audio/wav;base64,UklGRjIAAABXQVZFZm10IBIAAAABAAEAQB8AAEAfAAABAAgAAABMYXZjNTguMTMuMTAwAAAAAAAAAAAAAA==');
                    breakSound.volume = 0.5;
                    breakSound.play();
                } catch (e) {
                    console.log("Audio not supported");
                }
            }
            
            // Drag and drop functionality
            sodiumElement.addEventListener('dragstart', dragStart);
            chlorineElement.addEventListener('dragstart', dragStart);
            
            dropZone.addEventListener('dragover', dragOver);
            dropZone.addEventListener('dragleave', dragLeave);
            dropZone.addEventListener('drop', drop);
            
            function dragStart(e) {
                e.dataTransfer.setData('text/plain', e.target.id);
                this.style.opacity = '0.7';
            }
            
            function dragOver(e) {
                e.preventDefault();
                this.classList.add('active');
            }
            
            function dragLeave(e) {
                this.classList.remove('active');
            }
            
            function drop(e) {
                e.preventDefault();
                this.classList.remove('active');
                
                const id = e.dataTransfer.getData('text/plain');
                const element = document.getElementById(id);
                element.style.opacity = '1';
                
                // Add element to the dropped elements array
                if (id === 'sodium') {
                    droppedElements.push('Na');
                    hintArea.textContent = 'Sodium (Na) added. Sodium is a highly reactive alkali metal.';
                } else if (id === 'chlorine') {
                    droppedElements.push('Cl');
                    hintArea.textContent = 'Chlorine (Cl) added. Chlorine is a greenish-yellow gas at room temperature.';
                }
                
                updateFormulaDisplay();
            }
            
            function updateFormulaDisplay() {
                let formula = droppedElements.join(' + ');
                if (droppedElements.length === 0) {
                    formula = '? + ?';
                } else if (droppedElements.length === 1) {
                    formula += ' + ?';
                }
                formulaDisplay.textContent = `${formula} → NaCl`;
                
                // Update the drop zone text
                if (droppedElements.length === 0) {
                    dropZone.textContent = 'Drop elements here';
                } else if (droppedElements.length === 1) {
                    dropZone.textContent = `${droppedElements[0]} added, one more needed`;
                } else {
                    dropZone.textContent = `${droppedElements.join(' + ')} added`;
                }
                
                // Add glitch effect to formula
                if (droppedElements.length > 0) {
                    formulaDisplay.style.textShadow = '2px 0 #77ffff, -2px 0 #ffaa00, 0 0 10px #33ff33';
                    setTimeout(() => {
                        formulaDisplay.style.textShadow = '0 0 5px #33ff33';
                    }, 500);
                }
            }
            
            // Check solution
            checkBtn.addEventListener('click', function() {
                if (droppedElements.length < 2) {
                    hintArea.textContent = 'You need to add both sodium and chlorine to form salt.';
                    return;
                }
                
                // Check for correct elements (order doesn't matter)
                const hasNa = droppedElements.includes('Na');
                const hasCl = droppedElements.includes('Cl');
                
                if (hasNa && hasCl) {
                    // Success!
                    levelComplete.style.display = 'flex';
                    hintArea.textContent = 'Correct! Sodium and chlorine combine to form sodium chloride (NaCl).';
                    
                    // Success sound effect
                    try {
                        const successSound = new Audio('data:audio/wav;base64,UklGRjIAAABXQVZFZm10IBIAAAABAAEAQB8AAEAfAAABAAgAAABMYXZjNTguMTMuMTAwAAAAAAAAAAAAAA==');
                        successSound.volume = 0.5;
                        successSound.play();
                    } catch (e) {
                        console.log("Audio not supported");
                    }
                } else {
                    hintArea.textContent = 'That\'s not quite right. You need both sodium (Na) and chlorine (Cl).';
                }
            });
            
            // Reset button
            nextLevelBtn.addEventListener('click', function() {
                window.location.href = "index8.html";
            });
            document.getElementById('return-to-menu').addEventListener('click', function() {
    // First save current progress before returning to menu
    // If you haven't collected the elements yet, you might want to add logic
    // to prompt the user that progress won't be saved
    
    // Redirect to the landing page
    window.location.href = 'index.html';
});
            // Add reset functionality
            dropZone.addEventListener('dblclick', function() {
                droppedElements = [];
                updateFormulaDisplay();
                hintArea.textContent = 'Formula reset. Try placing the elements again.';
            });
            
            // Add glitch effect
            function glitchEffect() {
                const elements = document.querySelectorAll('.element, .btn, .crystal-text');
                elements.forEach(el => {
                    const origColor = el.style.color;
                    const origShadow = el.style.textShadow;
                    
                    // Random glitch
                    if (Math.random() > 0.97) {
                        el.style.transform = `translate(${Math.random() * 4 - 2}px, ${Math.random() * 4 - 2}px)`;
                        el.style.textShadow = `0 0 5px #fff, 0 0 10px #33ff33`;
                        
                        setTimeout(() => {
                            el.style.transform = '';
                            el.style.textShadow = origShadow;
                        }, 100);
                    }
                });
                
                requestAnimationFrame(glitchEffect);
            }
            
            // Start the glitch effect
            glitchEffect();
            
            // Initial hint
            hintArea.textContent = 'Click on the salt crystal to break it and reveal its elements.';
        });
    </script>
</body>
</html>