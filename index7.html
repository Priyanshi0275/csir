<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Level 7: Salt Flats - Sodium and Chlorine</title>
    <style>
@import url('https://fonts.googleapis.com/css2?family=Fredoka+One&display=swap');

@font-face {
    font-family: 'PixelFont';
    src: url('https://cdnjs.cloudflare.com/ajax/libs/VT323/1.3.1/VT323-Regular.ttf') format('truetype');
}

body {
    margin: 0;
    padding: 0;
    font-family: 'Fredoka One', cursive, monospace;
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    color: #2c2c72;
    height: 100vh;
    overflow: hidden;
    display: flex;
    flex-direction: column;
    image-rendering: pixelated;
    position: relative;
}

body::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><defs><pattern id="stars" x="0" y="0" width="20" height="20" patternUnits="userSpaceOnUse"><circle cx="10" cy="10" r="1" fill="rgba(255,255,255,0.1)"/></pattern></defs><rect width="100" height="100" fill="url(%23stars)"/></svg>');
    pointer-events: none;
    z-index: 1;
}

.header {
    background: linear-gradient(90deg, #ff6b6b, #4ecdc4, #45b7d1, #96ceb4);
    background-size: 400% 400%;
    animation: gradientShift 3s ease infinite;
    color: white;
    padding: 15px 20px;
    text-align: center;
    box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
    border-bottom: 3px solid #fff;
    text-transform: uppercase;
    letter-spacing: 3px;
    font-size: 1.8rem;
    text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
    position: relative;
    z-index: 10;
}

@keyframes gradientShift {
    0% { background-position: 0% 50%; }
    50% { background-position: 100% 50%; }
    100% { background-position: 0% 50%; }
}

.container {
    display: flex;
    flex: 1;
    overflow: hidden;
}

.left-panel, .right-panel {
    flex: 1;
    padding: 25px;
    display: flex;
    flex-direction: column;
    align-items: center;
    overflow-y: auto;
    border: 3px solid #fff;
    background: rgba(255, 255, 255, 0.95);
    backdrop-filter: blur(10px);
    box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
    border-radius: 15px;
    margin: 10px;
    position: relative;
    z-index: 5;
}

.crystal-container {
    position: relative;
    width: 320px;
    height: 320px;
    background: linear-gradient(45deg, #1a1a2e, #16213e, #0f3460);
    border: 4px solid #fff;
    outline: 3px solid #ff6b6b;
    display: flex;
    justify-content: center;
    align-items: center;
    margin-bottom: 25px;
    border-radius: 20px;
    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3), inset 0 0 20px rgba(255, 255, 255, 0.1);
    animation: glow 2s ease-in-out infinite alternate;
}

@keyframes glow {
    from { box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3), inset 0 0 20px rgba(255, 255, 255, 0.1), 0 0 20px rgba(255, 107, 107, 0.5); }
    to { box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3), inset 0 0 20px rgba(255, 255, 255, 0.1), 0 0 40px rgba(255, 107, 107, 0.8); }
}

.salt-crystal {
    width: 220px;
    height: 220px;
    background: linear-gradient(135deg, #ffd700, #ffed4e, #fff8dc);
    position: relative;
    cursor: pointer;
    box-shadow: 0 0 30px rgba(255, 215, 0, 0.6);
    display: flex;
    justify-content: center;
    align-items: center;
    transition: all 0.4s ease;
    transform: scale(1);
    clip-path: polygon(
        50% 0%, 
        100% 25%, 
        100% 75%, 
        50% 100%, 
        0% 75%, 
        0% 25%
    );
    border: 3px solid #fff;
}

.salt-crystal:before {
    content: '';
    position: absolute;
    width: 85%;
    height: 85%;
    background: linear-gradient(45deg, #ffed4e, #ffd700, #ffb347);
    clip-path: polygon(
        50% 0%, 
        100% 25%, 
        100% 75%, 
        50% 100%, 
        0% 75%, 
        0% 25%
    );
    z-index: -1;
    filter: brightness(1.2);
}

.salt-crystal:hover {
    transform: scale(1.1) rotate(5deg);
    box-shadow: 0 0 50px rgba(255, 215, 0, 0.8);
    background: linear-gradient(135deg, #ffed4e, #ffd700, #ffb347);
    animation: sparkle 0.6s ease-in-out;
}

@keyframes sparkle {
    0%, 100% { filter: brightness(1); }
    50% { filter: brightness(1.3) saturate(1.2); }
}

.crystal-text {
    font-size: 52px;
    font-weight: bold;
    color: #2c2c72;
    text-shadow: 3px 3px 0 #fff, -3px -3px 0 #fff, 3px -3px 0 #fff, -3px 3px 0 #fff, 0 0 10px rgba(44, 44, 114, 0.5);
    animation: textGlow 2s ease-in-out infinite alternate;
}

@keyframes textGlow {
    from { text-shadow: 3px 3px 0 #fff, -3px -3px 0 #fff, 3px -3px 0 #fff, -3px 3px 0 #fff, 0 0 10px rgba(44, 44, 114, 0.5); }
    to { text-shadow: 3px 3px 0 #fff, -3px -3px 0 #fff, 3px -3px 0 #fff, -3px 3px 0 #fff, 0 0 20px rgba(44, 44, 114, 0.8); }
}

.elements {
    display: flex;
    justify-content: space-around;
    width: 100%;
    margin-top: 40px;
}

.element {
    width: 90px;
    height: 90px;
    display: flex;
    justify-content: center;
    align-items: center;
    font-size: 32px;
    font-weight: 900;
    opacity: 0.8;
    transition: all 0.4s ease;
    cursor: pointer;
    border: 4px solid;
    border-image-slice: 1;
    border-radius: 15px;
    transform: scale(1);
    image-rendering: pixelated;
    box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
    position: relative;
    overflow: hidden;
}

.element::before {
    content: '';
    position: absolute;
    top: -50%;
    left: -50%;
    width: 200%;
    height: 200%;
    background: linear-gradient(45deg, transparent, rgba(255, 255, 255, 0.3), transparent);
    transform: rotate(45deg);
    transition: all 0.6s ease;
    opacity: 0;
}

.element:hover::before {
    opacity: 1;
    transform: rotate(45deg) translateX(100%);
}

.sodium {
    background: linear-gradient(135deg, #ff6b6b, #ff8e8e, #ffa5a5);
    border-color: #ff4757;
    color: white;
    box-shadow: 0 0 20px rgba(255, 107, 107, 0.6);
    text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
}

.chlorine {
    background: linear-gradient(135deg, #4ecdc4, #44a08d, #96ceb4);
    border-color: #00d2d3;
    color: white;
    box-shadow: 0 0 20px rgba(78, 205, 196, 0.6);
    text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
}

.element.active {
    opacity: 1;
    transform: scale(1.2);
    animation: pulse 1.5s infinite;
    box-shadow: 0 0 30px rgba(255, 107, 107, 0.8);
    border-width: 5px;
}

.element.active.chlorine {
    box-shadow: 0 0 30px rgba(78, 205, 196, 0.8);
}

@keyframes pulse {
    0% { transform: scale(1.15); }
    50% { transform: scale(1.25); }
    100% { transform: scale(1.15); }
}

.puzzle-container {
    width: 100%;
    padding: 25px;
    background: linear-gradient(135deg, #f8f9fa, #e9ecef, #dee2e6);
    border: 3px solid #fff;
    outline: 2px solid #ff6b6b;
    display: flex;
    flex-direction: column;
    align-items: center;
    border-radius: 20px;
    box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
    position: relative;
    overflow: hidden;
}

.puzzle-container::before {
    content: '';
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.4), transparent);
    animation: shimmer 3s infinite;
}

@keyframes shimmer {
    0% { left: -100%; }
    100% { left: 100%; }
}

.puzzle-title {
    font-size: 24px;
    font-weight: bold;
    margin-bottom: 15px;
    color: #2c2c72;
    text-transform: uppercase;
    letter-spacing: 3px;
}

.formula-display {
    font-size: 28px;
    margin: 15px 0;
    padding: 10px 20px;
    background-color: #f0e8e8;
    border: 2px solid #2c2c72;
    color: #2c2c72;
    font-family: 'Fredoka One', cursive, monospace;
    text-shadow: 0 0 5px #2c2c72;
}

.element-dropzone {
    width: 80%;
    height: 100px;
    border: 3px dashed #444;
    display: flex;
    justify-content: center;
    align-items: center;
    margin: 20px 0;
    font-size: 16px;
    color: #888;
    background-color: #0a0a0a;
}

.element-dropzone.active {
    border-color: #2c2c72;
    background-color: rgba(51, 128, 255, 0.1);
}

.journal {
    margin-top: 20px;
    padding: 15px;
    background-color: #f0e8e8;
    border: 2px solid #555;
    border-left: 4px solid #2c2c72;
    font-style: italic;
    width: 80%;
    color: #666;
}

.level-complete {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: #f0e8e8;
    display: none;
    justify-content: center;
    align-items: center;
    z-index: 100;
}

.complete-message {
    background-color: #f0e8e8;
    padding: 30px 50px;
    border: 4px solid #2c2c72;
    text-align: center;
    box-shadow: 0 0 20px rgba(51, 128, 255, 0.5);
    max-width: 80%;
    color: #2c2c72;
}

.complete-message h2 {
    color: #2c2c72;
    margin-bottom: 20px;
    text-transform: uppercase;
    letter-spacing: 2px;
}

.complete-message p {
    margin-bottom: 30px;
    font-size: 18px;
}

.btn {
    padding: 10px 25px;
    background-color: #f0e8e8;
    color: #2c2c72;
    border: 2px solid #2c2c72;
    cursor: pointer;
    font-size: 16px;
    transition: all 0.3s;
    font-family: 'Fredoka One', cursive, monospace;
    text-transform: uppercase;
    letter-spacing: 1px;
}

.btn:hover {
    background-color: #2c2c72;
    color: #fff;
    transform: translateY(-2px);
}

.salt-fragments {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    pointer-events: none;
}

.fragment {
    position: absolute;
    width: 16px;
    height: 16px;
    background-color: #444;
    border: 1px solid #666;
    transition: transform 0.5s ease, opacity 0.5s ease;
}

.instructions {
    background-color: rgba(51, 128, 255, 0.1);
    padding: 15px;
    border: 2px solid #222;
    margin: 20px 0;
    width: 80%;
    text-align: center;
    color: #666;
}

/* Pixelated border effect */
.pixel-border {
    position: relative;
}

.pixel-border:after {
    content: "";
    position: absolute;
    top: -4px;
    left: -4px;
    right: -4px;
    bottom: -4px;
    background: transparent;
    border: 4px solid #2c2c72;
    clip-path: polygon(
        0% 0%, 12.5% 0%, 12.5% 12.5%, 
        25% 12.5%, 25% 0%, 37.5% 0%, 
        37.5% 12.5%, 50% 12.5%, 50% 0%, 
        62.5% 0%, 62.5% 12.5%, 75% 12.5%, 
        75% 0%, 87.5% 0%, 87.5% 12.5%, 
        100% 12.5%, 100% 25%, 87.5% 25%, 
        87.5% 37.5%, 100% 37.5%, 100% 50%, 
        87.5% 50%, 87.5% 62.5%, 100% 62.5%, 
        100% 75%, 87.5% 75%, 87.5% 87.5%, 
        100% 87.5%, 100% 100%, 87.5% 100%, 
        87.5% 87.5%, 75% 87.5%, 75% 100%, 
        62.5% 100%, 62.5% 87.5%, 50% 87.5%, 
        50% 100%, 37.5% 100%, 37.5% 87.5%, 
        25% 87.5%, 25% 100%, 12.5% 100%, 
        12.5% 87.5%, 0% 87.5%, 0% 75%, 
        12.5% 75%, 12.5% 62.5%, 0% 62.5%, 
        0% 50%, 12.5% 50%, 12.5% 37.5%, 
        0% 37.5%, 0% 25%, 12.5% 25%, 
        12.5% 12.5%, 0% 12.5%
    );
    pointer-events: none;
}

/* Scanlines effect */
body:after {
    content: "";
    display: block;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: repeating-linear-gradient(
        0deg,
        rgba(0, 0, 0, 0.1),
        rgba(0, 0, 0, 0.1) 1px,
        transparent 1px,
        transparent 2px
    );
    pointer-events: none;
    z-index: 999;
}

/* CRT effect */
body:before {
    content: "";
    display: block;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: radial-gradient(
        circle at center,
        transparent 0%,
        rgba(0, 0, 0, 0.2) 90%,
        rgba(0, 0, 0, 0.8) 100%
    );
    pointer-events: none;
    z-index: 998;
}
</style>
</head>
<body>
    <audio id="click-sound" src="sounds/click.mp3" preload="auto"></audio>
    <audio id="start-sound" src="sounds/start.mp3" preload="auto"></audio>
    <audio id="bg-music" src="sounds/background.mp3" preload="auto" loop></audio>
    <audio id="yay-sound" src="sounds/yay.mp3" preload="auto"></audio>
    <div class="header">
        <h1>Level 7: Salt Flats</h1>
        <h3>Discover Sodium and Chlorine</h3>
    </div>
    
    <div class="container">
        <div class="left-panel">
            <div class="how-to-play" style="background:#fffbe6;border:2px solid #ffe066;padding:15px;margin-bottom:15px;border-radius:10px;color:#2c2c72;font-size:1.1em;">
              <b>How to Play:</b>
              <ol style="margin:10px 0 0 20px;padding:0;">
                <li>Click the salt crystal to break it and reveal the elements.</li>
                <li>Drag <b>Na</b> (Sodium) and <b>Cl</b> (Chlorine) to the drop zone to form NaCl.</li>
                <li>Click <b>Check Solution</b> to see if you are correct.</li>
                <li>Double-click the drop zone to reset your answer.</li>
                <li>Use the journal for hints and information.</li>
              </ol>
            </div>
            
            <div class="journal">
                <p>"Two elements in the salt you eat. Break apart the crystal structure to reveal what lies within."</p>
            </div>
            
            <div class="instructions">
                <p>Click on the salt crystal to break it apart. Then drag the elements to the formula area to solve the puzzle.</p>
            </div>
            
            <div class="crystal-container pixel-border">
                <div class="salt-crystal" id="saltCrystal">
                    <span class="crystal-text">NaCl</span>
                </div>
                <div class="salt-fragments" id="saltFragments"></div>
            </div>
            
            <div class="elements">
                <div class="element sodium" id="sodium" draggable="true">Na</div>
                <div class="element chlorine" id="chlorine" draggable="true">Cl</div>
            </div>
        </div>
        
        <div class="right-panel">
            <div class="puzzle-container pixel-border">
                <div class="puzzle-title">Chemical Formula Puzzle</div>
                <div class="formula-display" id="formulaDisplay">
                    ? + ? → NaCl
                </div>
                
                <p>Drag and drop the elements in the correct order:</p>
                
                <div class="element-dropzone" id="dropZone">
                    Drop elements here
                </div>
                
                <button class="btn" id="checkBtn">Check Solution</button>
                
                <div id="hintArea" style="margin-top: 20px; font-style: italic; color: #945e7b;"></div>
            </div>
        </div>
    </div>
    
    <div class="level-complete" id="levelComplete">
        <div class="complete-message pixel-border">
            <h2>Level Complete!</h2>
            <p>You've successfully unlocked sodium and chlorine by breaking apart the salt crystal structure!</p>
            <p>These two reactive elements combine to form the salt we use every day.</p>
            <button class="btn" id="nextLevelBtn">Go to Next Level</button>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const saltCrystal = document.getElementById('saltCrystal');
            const saltFragments = document.getElementById('saltFragments');
            const sodiumElement = document.getElementById('sodium');
            const chlorineElement = document.getElementById('chlorine');
            const dropZone = document.getElementById('dropZone');
            const checkBtn = document.getElementById('checkBtn');
            const formulaDisplay = document.getElementById('formulaDisplay');
            const levelComplete = document.getElementById('levelComplete');
            const nextLevelBtn = document.getElementById('nextLevelBtn');
            const hintArea = document.getElementById('hintArea');
            
            let isCrystalBroken = false;
            let droppedElements = [];
            
            // Make elements initially inactive
            sodiumElement.style.pointerEvents = 'none';
            chlorineElement.style.pointerEvents = 'none';
            
            // Add pixelated crystal break effect
            function createPixelatedFragments() {
                saltFragments.innerHTML = '';
                // Create 6x6 grid of pixels
                for (let y = 0; y < 6; y++) {
                    for (let x = 0; x < 6; x++) {
                        const fragment = document.createElement('div');
                        fragment.className = 'fragment';
                        // Position in grid
                        const baseX = 50 + (x - 3) * 20;
                        const baseY = 50 + (y - 3) * 20;
                        fragment.style.left = `${baseX + 25}px`;
                        fragment.style.top = `${baseY + 25}px`;
                        
                        // Different colors for fragments
                        if ((x + y) % 3 === 0) {
                            fragment.style.backgroundColor = '#77ffff';
                            fragment.style.border = '1px solid #aaffff';
                        } else if ((x + y) % 3 === 1) {
                            fragment.style.backgroundColor = '#ffaa00';
                            fragment.style.border = '1px solid #ffcc00';
                        } else {
                            fragment.style.backgroundColor = '#00ff66';
                            fragment.style.border = '1px solid #00ffaa';
                        }
                        
                        saltFragments.appendChild(fragment);
                    }
                }
            }
            
            // Crystal breaking animation
            saltCrystal.addEventListener('click', function() {
                if (!isCrystalBroken) {
                    breakCrystal();
                    
                    // Make elements active after crystal breaks
                    setTimeout(() => {
                        sodiumElement.classList.add('active');
                        chlorineElement.classList.add('active');
                        sodiumElement.style.pointerEvents = 'auto';
                        chlorineElement.style.pointerEvents = 'auto';
                        
                        hintArea.textContent = 'The crystal has broken! Now you can use the elements.';
                    }, 1500);
                    
                    isCrystalBroken = true;
                }
            });
            
            function breakCrystal() {
                // Create pixelated fragments
                createPixelatedFragments();
                
                // Animate crystal breaking
                saltCrystal.style.opacity = '0';
                saltCrystal.style.transform = 'scale(0.8)';
                
                // Animate fragments flying away
                setTimeout(() => {
                    const fragments = document.querySelectorAll('.fragment');
                    fragments.forEach((fragment, index) => {
                        const angle = (index / fragments.length) * Math.PI * 2;
                        const distance = 50 + Math.random() * 150;
                        const xPos = Math.cos(angle) * distance;
                        const yPos = Math.sin(angle) * distance;
                        fragment.style.transform = `translate(${xPos}px, ${yPos}px) rotate(${Math.random() * 360}deg)`;
                        fragment.style.opacity = '0';
                    });
                }, 100);
                
                // Audio effect for crystal breaking
                try {
                    const breakSound = new Audio('data:audio/wav;base64,UklGRjIAAABXQVZFZm10IBIAAAABAAEAQB8AAEAfAAABAAgAAABMYXZjNTguMTMuMTAwAAAAAAAAAAAAAA==');
                    breakSound.volume = 0.5;
                    breakSound.play();
                } catch (e) {
                    console.log("Audio not supported");
                }
            }
            
            // Drag and drop functionality
            sodiumElement.addEventListener('dragstart', dragStart);
            chlorineElement.addEventListener('dragstart', dragStart);
            
            dropZone.addEventListener('dragover', dragOver);
            dropZone.addEventListener('dragleave', dragLeave);
            dropZone.addEventListener('drop', drop);
            
            function dragStart(e) {
                e.dataTransfer.setData('text/plain', e.target.id);
                this.style.opacity = '0.7';
            }
            
            function dragOver(e) {
                e.preventDefault();
                this.classList.add('active');
            }
            
            function dragLeave(e) {
                this.classList.remove('active');
            }
            
            function drop(e) {
                e.preventDefault();
                this.classList.remove('active');
                
                const id = e.dataTransfer.getData('text/plain');
                const element = document.getElementById(id);
                element.style.opacity = '1';
                
                // Add element to the dropped elements array
                if (id === 'sodium') {
                    droppedElements.push('Na');
                    hintArea.textContent = 'Sodium (Na) added. Sodium is a highly reactive alkali metal.';
                } else if (id === 'chlorine') {
                    droppedElements.push('Cl');
                    hintArea.textContent = 'Chlorine (Cl) added. Chlorine is a greenish-yellow gas at room temperature.';
                }
                
                updateFormulaDisplay();
            }
            
            function updateFormulaDisplay() {
                let formula = droppedElements.join(' + ');
                if (droppedElements.length === 0) {
                    formula = '? + ?';
                } else if (droppedElements.length === 1) {
                    formula += ' + ?';
                }
                formulaDisplay.textContent = `${formula} → NaCl`;
                
                // Update the drop zone text
                if (droppedElements.length === 0) {
                    dropZone.textContent = 'Drop elements here';
                } else if (droppedElements.length === 1) {
                    dropZone.textContent = `${droppedElements[0]} added, one more needed`;
                } else {
                    dropZone.textContent = `${droppedElements.join(' + ')} added`;
                }
                
                // Add glitch effect to formula
                if (droppedElements.length > 0) {
                    formulaDisplay.style.textShadow = '2px 0 #77ffff, -2px 0 #ffaa00, 0 0 10px #33ff33';
                    setTimeout(() => {
                        formulaDisplay.style.textShadow = '0 0 5px #33ff33';
                    }, 500);
                }
            }
            
            // Check solution
            checkBtn.addEventListener('click', function() {
                if (droppedElements.length < 2) {
                    hintArea.textContent = 'You need to add both sodium and chlorine to form salt.';
                    return;
                }
                
                // Check for correct elements (order doesn't matter)
                const hasNa = droppedElements.includes('Na');
                const hasCl = droppedElements.includes('Cl');
                
                if (hasNa && hasCl) {
                    // Success!
                    levelComplete.style.display = 'flex';
                    hintArea.textContent = 'Correct! Sodium and chlorine combine to form sodium chloride (NaCl).';
                    
                    // Success sound effect
                    try {
                        const successSound = new Audio('data:audio/wav;base64,UklGRjIAAABXQVZFZm10IBIAAAABAAEAQB8AAEAfAAABAAgAAABMYXZjNTguMTMuMTAwAAAAAAAAAAAAAA==');
                        successSound.volume = 0.5;
                        successSound.play();
                    } catch (e) {
                        console.log("Audio not supported");
                    }
                } else {
                    hintArea.textContent = 'That\'s not quite right. You need both sodium (Na) and chlorine (Cl).';
                }
            });
            
            // Reset button
            nextLevelBtn.addEventListener('click', function() {
                window.location.href = "index8.html";
            });
            
            // Add reset functionality
            dropZone.addEventListener('dblclick', function() {
                droppedElements = [];
                updateFormulaDisplay();
                hintArea.textContent = 'Formula reset. Try placing the elements again.';
            });
            
            // Add glitch effect
            function glitchEffect() {
                const elements = document.querySelectorAll('.element, .btn, .crystal-text');
                elements.forEach(el => {
                    const origColor = el.style.color;
                    const origShadow = el.style.textShadow;
                    
                    // Random glitch
                    if (Math.random() > 0.97) {
                        el.style.transform = `translate(${Math.random() * 4 - 2}px, ${Math.random() * 4 - 2}px)`;
                        el.style.textShadow = `0 0 5px #fff, 0 0 10px #33ff33`;
                        
                        setTimeout(() => {
                            el.style.transform = '';
                            el.style.textShadow = origShadow;
                        }, 100);
                    }
                });
                
                requestAnimationFrame(glitchEffect);
            }
            
            // Start the glitch effect
            glitchEffect();
            
            // Initial hint
            hintArea.textContent = 'Click on the salt crystal to break it and reveal its elements.';
            
            // Audio functionality
            const clickSound = document.getElementById('click-sound');
            const startSound = document.getElementById('start-sound');
            const bgMusic = document.getElementById('bg-music');
            const yaySound = document.getElementById('yay-sound');

            // Start background music immediately on page load
            bgMusic.volume = 0.3;
            bgMusic.play().catch(() => {});

            // Add click sound to interactive elements
            const soundClickTargets = document.querySelectorAll('button, .salt-crystal, .element, #dropZone, .btn');
            soundClickTargets.forEach(el => {
                el.addEventListener('click', () => {
                    clickSound.currentTime = 0;
                    clickSound.play().catch(() => {});
                });
            });

            // Add start sound to check button
            checkBtn.addEventListener('click', () => {
                startSound.currentTime = 0;
                startSound.play().catch(() => {});
            });

            // Add yay sound when level is complete
            const observer = new MutationObserver((mutations) => {
                mutations.forEach((mutation) => {
                    if (mutation.type === 'attributes' && mutation.attributeName === 'style') {
                        if (levelComplete.style.display === 'flex') {
                            yaySound.currentTime = 0;
                            yaySound.play().catch(() => {});
                        }
                    }
                });
            });
            observer.observe(levelComplete, { attributes: true });

            // Add sound to crystal breaking
            saltCrystal.addEventListener('click', () => {
                clickSound.currentTime = 0;
                clickSound.play().catch(() => {});
            });

            // Add sound to element dragging
            sodiumElement.addEventListener('dragstart', () => {
                clickSound.currentTime = 0;
                clickSound.play().catch(() => {});
            });

            chlorineElement.addEventListener('dragstart', () => {
                clickSound.currentTime = 0;
                clickSound.play().catch(() => {});
            });
        });
    </script>
</body>
</html>